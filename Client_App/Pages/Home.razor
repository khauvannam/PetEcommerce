@page "/"
@using Client_App.Components.Home
@using Client_App.Domains.Categories.Responses
@using Client_App.Domains.Products.Responses
@using Client_App.Interfaces


<Slider/>

<Discover Categories="Categories"/>

<ScienceBaked/>

<BestSeller Products="Products"/>

@* Customer Stories  (later) *@

<Feature/>

<Collection Categories="Categories"/>

@code {
    public List<ProductModel> Products = [];
    public List<Category> Categories = [];
    [Inject] public ICategoryService<Category> CategoryService { get; set; } = null!;
    [Inject] public IProductService<ProductModel> ProductService { get; set; } = null!;

    private readonly List<string> _excludedCategories = ["best-sellers", "all"];

    protected override async Task OnInitializedAsync()
    {
        Products = await ProductService.GetProductsByConditionAsync(0, null,true,4);
        
        Categories = (await CategoryService.GetAllAsync()).Where(c => !_excludedCategories.Contains(c.Endpoint)).ToList();
        StateHasChanged();
    }

}